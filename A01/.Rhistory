mydata$vehicle.make[1:5]
mydata <- read.csv("stat231f25dataset.csv")
setwd("C:/Users/wujas/Desktop/LearningR/A01")
# Introductory Material // Loading Dataset
mydata <- read.csv("stat231f25dataset.csv")
dim(mydata)
colnames(mydata)
mydata[1:5, 13:14]
mydata$vehicle.make[1:5]
# Checking NA values
sum(is.na(mydata))
mydata$vehicle.make[1:5]
source("C:/Users/wujas/Desktop/LearningR/A01/Analysis 1.R")
vehicle_make <- mydata$vehicle.make
subject_race <- mydata$subject.race
vehicle_make[1:5]
vehicle_make[1:5]
subject_race[1:5]
table_vehicle <- table(vehicle_make)
table_vehicle
table_race
table_race <- table(subject_race)
table_race
# frequencies and divide by the total:
total <- sum(table_vehicle)
percent_vehicle <- (100 * (table_vehicle) / total)
percent_vehicle
<- (100* (table_race) / total)
percent_race <- (100* (table_race) / total)
percent_race
final_table <- table(table_vehicle, percent_vehicle)
final_table
cities <- mydata$city
# Looking for a table to create a grouped barplot
vehicle_stops <- table(vehicle_make, cities)
race_stops <- table(subject_race, cities)
vehicle_stops
source("C:/Users/wujas/Desktop/LearningR/A01/Analysis 1.R", echo = TRUE)
# Looks good, moving on to creating a grouped barchart
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"),
ylim = c(0, 100), density = 50, angle = c(45, 135))
# Looking for a table to create a grouped barplot
vehicle_stops <- table(cities, vehicle_make)
race_stops <- table(cities, subject_race)
# Viewing our data
vehicle_stops
race_stops
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"),
ylim = c(0, 100), density = 50, angle = c(45, 135))
# Looks good, moving on to creating a grouped barchart
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"),
ylim = c(0, 425), density = 50, angle = c(45, 135))
race_bar_plot <- barplot(race_stops)
race_bar_plot <- barplot(race_stops, beside=T)
race_bar_plot <- barplot(race_stops, beside=T, col=c("forestgreen", "dodgerblue3"))
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"))
vehicle_make <- mydata$vehicle.make
subject_race <- mydata$subject.race
vehicle_make
legend("topright", legend=c("1", "2"), fill = c("forestgreen", "dodgerblue3"),
density=50, angle=c(45, 135))
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"))
legend("topright", legend=c("NO", "SA"), fill = c("forestgreen", "dodgerblue3"),
density=50, angle=c(45, 135))
race_bar_plot <- barplot(race_stops, beside=T, col=c("forestgreen", "dodgerblue3"))
# 1c)
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"))
legend("topright", legend=c("1", "2"), fill = c("forestgreen", "dodgerblue3"),
density=50, angle=c(45, 135))
race_bar_plot <- barplot(race_stops, beside=T, col=c("forestgreen", "dodgerblue3"))
legend("topright", legend=c("1", "2"), fill = c("forestgreen", "dodgerblue3"),
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"))
legend("topright", legend=c("1", "2"), fill = c("forestgreen", "dodgerblue3"),
legend("topright", legend=c("1", "2"), fill = c("forestgreen", "dodgerblue3"),
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"))
legend("topright", legend=c("1", "2"), fill = c("forestgreen", "dodgerblue3"),
vehicle_bar_plot <- barplot(vehicle_stops, beside=T, xlab="Vehicle Makes",
ylab = "Stop Frequencies", las = 1,
main = "stops from vehicle.make and cities",
col = c("forestgreen", "dodgerblue3"))
legend("topright", legend=c("1", "2"), fill = c("forestgreen", "dodgerblue3"),
density=50, angle=c(45, 135))
legend("topright", legend=c("NO", "SA"), fill = c("forestgreen", "dodgerblue3"),
density=50, angle=c(45, 135))
View(mydata)
View(mydata)
# Saving tables for wanted data
vehicle_make <- mydata$vehicle.make
subject_race <- mydata$subject.race
# Taking into account the city they're recorded in
vehicle_make_SA <- subset(vehicle_make, city == "SA")
Saving tables for wanted data
vehicle_make <- mydata$vehicle.make
subject_race <- mydata$subject.race
# Taking into account the city they're recorded in
vehicle_make_SA <- subset(vehicle_make, cities == "SA")
vehicle_make_NO <- subset(vehicle_make, cities == "NO")
subject_race_SA <- subset(subject_race, cities == "SA")
subject_race_NO <- subset(subject_race, cities == "NO")
vehicle_make_SA
# Taking into account the city they're recorded in
vehicle_make_SA <- subset(vehicle_make, cities == "sa")
vehicle_make_NO <- subset(vehicle_make, cities == "no")
subject_race_SA <- subset(subject_race, cities == "sa")
subject_race_NO <- subset(subject_race, cities == "no")
vehicle_make_SA
proptable(vehicle_make_SA)
prop(vehicle_make_SA)
prop.(vehicle_make_SA)
prop.table(vehicle_make_SA)
prop.table(vehicle_make_SA, 1)
prop.table(table(vehicle_make_SA), 1)
table(vehicle_make_SA)
# Taking into account the city they're recorded in
vehicle_make_SA <- subset(cities == "sa", vehicle_make)
# sorting by cities
cities = mydata$city
# Saving tables for wanted data
vehicle_make <- mydata$vehicle.make
subject_race <- mydata$subject.race
# Taking into account the city they're recorded in
vehicle_make_by_city <- table(vehicle_make, cities)
vehicle_make_by_city
prop.table(vehicle_make_by_city, 1)
subject_race_by_city <- table(subject_race, cities)
# Applying the same to race:
subject_race_by_city <- table(subject_race, cities)
subject_race_by_city
prop.table(subject_race_by_city, 1)
# Percentages of the table
NO = sum(city == "no")
# Percentages of the table
NO = sum(cities == "no")
SA = sum(cities == 'sa')
percent_vehicle = (100 * (vehicle_make_by_city == "no") / NO)
percent_vehicle
vehicle_make_by_city <- table(vehicle_make, cities)
vehicle_make_by_city
percent_vehicle = (100 * (vehicle_make_by_city == "no") / NO)
percent_vehicle
prop.table(vehicle_make_by_city, margin = 2) * 100
prop.table(subject_race_by_city, margin=2) * 100
View(mydata)
mydata$subject.age.log <- log(mydata$subject.age)
View(mydata)
SanAntonio <- subset(mydata, city=="sa")
SanAntonio
# Subject Age, Model Fit and Vehicle Year:
mydata$subject.age.log <- log(mydata$subject.age)
# Creating a subset of SanAntonio:
SanAntonio <- subset(mydata, city=="sa")
SanAntonio
# 2a)
# We want to calculate the sample mean, sample median and sample std
# sample skewness and sample kurtosis for each of subject.age.log and
# subject.age.log for San Antonio. Display your results in a table:
summary(SanAntonio$subject.age)
summary(SanAntonio$subject.age.log)
# Mean from the mean() function
mean(SanAntonio.age)
# Mean from the mean() function
mean(SanAntonio$subject.age)
mean(SanAntonio$subject.age.log)
# sample standard deviation
std(SanAntonio$subject.age)
# sample standard deviation
sd(SanAntonio$subject.age)
sd(SanAntonio$subject.age.log)
# sample standard deviation
age.sd <- sd(SanAntonio$subject.age)
age.log.sd <- sd(SanAntonio$subject.age.log)
# Skewness:
skewness <- function(x) {
(sum((x - mean(x))^3)/length(x))/(sum((x - mean(x))^2)/length(x))^(3/2)
}
#Kurtosis:
kurtosis <- function(x) {
(sum((x - mean(x))^4)/length(x))/(sum((x - mean(x))^2)/length(x))^2
}
age.kurtosis <- kurtosis(SanAntonio$subject.age)
age.log.kurtosis <- kurtosis(SanAntonio$subject.age.log)
age.kurtosis
age.log.kurtosis
age.skewness <- skewness(SanAntonio$subject.age)
age.log.skewness <- skewness(SanAntonio$subject.age.log)
age.kurtosis
age.log.kurtosis
table(age.kurtosis)
table(age.kurtosis, age.skewness)
table(age.kurtosis, age.skewness, age.mean, age.median)
age.mean <- mean(SanAntonio$subject.age)
age.log.meann <- mean(SanAntonio$subject.age.log)
table(age.kurtosis, age.skewness, age.mean, age.median)
table(age.kurtosis, age.skewness, age.mean)
View(SanAntonio)
View(SanAntonio)
library(MASS)
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
las=1,
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
las=0
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
las=0,
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
las=1,
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
col = "dodgerblue3")
library(MASS)
par(mfrow = c(1,2))
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age.log, xlab = "log Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of the Log of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age.log, xlab = "log Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of the Log of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age.log, xlab = "log Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of the Log of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
col = "dodgerblue3")
truehist(SanAntonio$subject.age.log, xlab = "log Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of the Log of Subject's Ages",
col = "dodgerblue3")
curve(dnorm(x, time.mean, time.sd), col="red", add=True)
truehist(SanAntonio$subject.age, xlab = "Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of Subject's Ages",
col = "dodgerblue3")
curve(dnorm(x, time.mean, time.sd), col="red", add=True)
curve(dnorm(x, time.mean, time.sd), col="red", add=TRUE)
curve(dnorm(x, age.mean, age.sd), col="red", add=TRUE)
curve(dnorm(x, age.mean, age.sd), col="red", add=TRUE, lwd=1.5)
age.log.mean <- mean(SanAntonio$subject.age.log)
truehist(SanAntonio$subject.age.log, xlab = "log Age of Subjects",
ylab = "Relative Frequency", main = "Relative Frequency Histogram of the Log of Subject's Ages",
col = "dodgerblue3")
curve(dnorm(x, age.log.mean, age.log.sd), col='red', add=TRUE, lwd=1.5)
